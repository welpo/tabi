<!doctype html><html lang=es><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self' https://cdn.jsdelivr.net/;style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self' https://tabi-stats.osc.garden vhiweeypifbwacashxjz.supabase.co;script-src 'self' https://tabi-stats.osc.garden  cdn.jsdelivr.net 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://welpo.github.io/tabi name=base><title>
~/tabi ‚Ä¢ Optimiza la carga con un subconjunto de fuente personalizado</title><link href=https://welpo.github.io/tabi/img/seedling.png rel=icon type=image/png><link href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50%" x="50%" dominant-baseline="central" text-anchor="middle" font-size="88">üå±</text></svg>' rel=icon><link title="~/tabi - Atom Feed" href=https://welpo.github.io/tabi/atom.xml rel=alternate type=application/atom+xml><link href="https://welpo.github.io/tabi/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://welpo.github.io/tabi/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><meta content="light dark" name=color-scheme><meta content=#087e96 name=theme-color><meta content="Aprende c√≥mo crear un subconjunto personalizado que solo incluya los glifos necesarios." name=description><meta content="Aprende c√≥mo crear un subconjunto personalizado que solo incluya los glifos necesarios." property=og:description><meta content="Optimiza la carga con un subconjunto de fuente personalizado" property=og:title><meta content=article property=og:type><meta content="https://welpo.github.io/tabi/blog/custom-font-subset/social_cards/es_blog_custom_font_subset.jpg?h=455b4fe2890a1f8b3f84" property=og:image><meta content=1400 property=og:image:width><meta content=800 property=og:image:height><meta content="https://welpo.github.io/tabi/blog/custom-font-subset/social_cards/es_blog_custom_font_subset.jpg?h=455b4fe2890a1f8b3f84" name=twitter:image><meta content=summary_large_image name=twitter:card><meta content=ca_ES property=og:locale:alternate><link href=https://welpo.github.io/tabi/ca/blog/custom-font-subset/ hreflang=ca rel=alternate><meta content=es_ES property=og:locale:alternate><link href=https://welpo.github.io/tabi/es/blog/custom-font-subset/ hreflang=es rel=alternate><meta content=en_GB property=og:locale:alternate><link href=https://welpo.github.io/tabi/blog/custom-font-subset/ hreflang=en rel=alternate><meta content=https://welpo.github.io/tabi/es/blog/custom-font-subset/ property=og:url><meta content=~/tabi property=og:site_name><noscript><link href=https://welpo.github.io/tabi/no_js.css rel=stylesheet></noscript><script src=https://welpo.github.io/tabi/js/initializeTheme.min.js></script><script defer src=https://welpo.github.io/tabi/js/themeSwitcher.min.js></script><script async data-goatcounter=https://tabi-stats.osc.garden/count src=https://tabi-stats.osc.garden/count.js></script><script src="https://welpo.github.io/tabi/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><script defer src=https://welpo.github.io/tabi/js/lunr/lunrStemmerSupport.min.js></script><script defer src=https://welpo.github.io/tabi/js/lunr/lunr.es.min.js></script><body><a href=#main-content id=skip-link>Saltar al contenido</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://welpo.github.io/tabi/es/>~/tabi</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/archive/>archivo </a><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/tags/>etiquetas </a><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/projects/>proyectos </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Haz clic o usa $SHORTCUT para abrir la b√∫squeda" class="search-icon interactive-icon" title="Haz clic o usa $SHORTCUT para abrir la b√∫squeda" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class=language-switcher><details class=dropdown><summary aria-label="Selecci√≥n de idioma" title="Selecci√≥n de idioma" aria-haspopup=true role=button><div class=language-switcher-icon></div></summary> <div class=dropdown-content role=menu>Espa√±ol<a aria-label=Catal√† href=https://welpo.github.io/tabi/ca/blog/custom-font-subset/ lang=ca role=menuitem>Catal√†</a><a aria-label=ÿßŸÑÿπÿ±ÿ®Ÿäÿ© href=https://welpo.github.io/tabi/ar/blog/custom-font-subset/ lang=ar role=menuitem>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a><a aria-label=English href=https://welpo.github.io/tabi/blog/custom-font-subset/ lang=en role=menuitem>English</a></div></details><li class="theme-switcher-wrapper js"><div aria-label="Cambiar a modo oscuro" title="Cambiar a modo oscuro/claro" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Restablecer modo a configuraci√≥n predeterminada" class="theme-resetter arrow" title="Restablecer modo a configuraci√≥n predeterminada" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">Optimiza la carga con un subconjunto de fuente personalizado</h1><a class="u-url u-uid" href=https://welpo.github.io/tabi/es/blog/custom-font-subset/></a><ul class=meta><li><time class=dt-published datetime=2023-04-29>29 abr 2023</time><li title="516 palabras"><span aria-hidden=true class=separator>‚Ä¢</span>3 mins de lectura<li class=tag><span aria-hidden=true class=separator>‚Ä¢</span>Etiquetas:¬†<li class=tag><a class=p-category href=https://welpo.github.io/tabi/es/tags/funcionalidad/>funcionalidad</a>,¬†<li class=tag><a class=p-category href=https://welpo.github.io/tabi/es/tags/tutorial/>tutorial</a></ul><ul class="meta last-updated"><li><time class=dt-updated datetime=2025-01-12>Actualizado el 12 ene 2025</time><li><span aria-hidden=true class=separator>‚Ä¢</span><a class=external href=https://github.com/welpo/tabi/commits/main/content/blog/custom-font-subset/index.es.md>Ver cambios</a></ul><p class=p-summary hidden>Aprende c√≥mo crear un subconjunto personalizado que solo incluya los glifos necesarios.<section class="e-content body"><h2 id=el-problema><a aria-label="Anchor link for: el-problema" class="header-anchor no-hover-padding" href=#el-problema><span aria-hidden=true class=link-icon></span></a> El problema</h2><p>Las fuentes personalizadas causan parpadeo de texto en Firefox. Para ver un gif y m√°s detalles, mira <a class=external href=https://github.com/welpo/tabi/issues/75 rel=external>esta issue</a>.<h2 id=la-solucion><a aria-label="Anchor link for: la-solucion" class="header-anchor no-hover-padding" href=#la-solucion><span aria-hidden=true class=link-icon></span></a> La soluci√≥n</h2><p>Para solucionar esto, tabi carga un subconjunto de glifos para el encabezado. Dado que esto aumenta ligeramente el tiempo de carga inicial, es una buena idea tratar de minimizar el tama√±o de este subconjunto.<p>Por defecto, tabi incluye archivos de subconjuntos para caracteres en ingl√©s y espa√±ol (con algunos s√≠mbolos). Estos archivos se cargan cuando la p√°gina o el sitio de Zola est√° en ese idioma.<div class="admonition tip"><div class="admonition-icon admonition-icon-tip"></div><div class=admonition-content><strong class=admonition-title>TIP</strong><p>Si est√°s usando una fuente personalizada, puedes crear tu propio subconjunto (ver m√°s abajo) o desactivar completamente los subconjuntos predeterminados con <code>enable_subset = false</code> en tu <code>config.toml</code>.</div></div><p>Para una optimizaci√≥n adicional, a continuaci√≥n ver√°s c√≥mo crear un subconjunto de fuentes personalizado que solo incluya los caracteres utilizados en tu encabezado.<h2 id=requisitos><a aria-label="Anchor link for: requisitos" class="header-anchor no-hover-padding" href=#requisitos><span aria-hidden=true class=link-icon></span></a> Requisitos</h2><p>Instala estas herramientas:<ul><li><p><a class=external href=https://github.com/fonttools/fonttools rel=external>fonttools</a></p><li><p><a class=external href=https://github.com/google/brotli rel=external>brotli</a></p></ul><p>Ejecuta <code>pip install fonttools brotli</code> para instalar ambas.<h2 id=el-script><a aria-label="Anchor link for: el-script" class="header-anchor no-hover-padding" href=#el-script><span aria-hidden=true class=link-icon></span></a> El script</h2><p>El script que sigue toma un archivo <code>config.toml</code> y un archivo de fuente como entrada, extrae los caracteres necesarios, crea un subconjunto de la fuente y genera un archivo CSS que contiene el subconjunto codificado en base64.<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-punctuation z-definition z-comment z-shebang z-shell z-meta z-shebang z-shell">#!/usr/bin/env bash</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-entity z-name z-function">usage</span><span class=z-punctuation>() {</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Usage: </span><span class="z-variable z-parameter">$0</span><span class="z-string z-punctuation z-definition z-string"> [--config | -c CONFIG_FILE] [--font | -f FONT_FILE] [--output | -o OUTPUT_PATH]"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Options:"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "  --config, -c   Path to the config.toml file."</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "  --font, -f     Path to the font file."</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "  --output, -o   Output path for the generated custom_subset.css file (default: current directory)"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "  --help, -h     Show this help message and exit"</span></span>
<span class=giallo-l><span class=z-punctuation>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># La salida predeterminada es el directorio actual.</span></span>
<span class=giallo-l><span class=z-source>output_path</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string z-string">"."</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Analiza las opciones de la l√≠nea de comandos.</span></span>
<span class=giallo-l><span class=z-keyword>while</span><span class=z-punctuation> [</span><span class="z-punctuation z-definition z-string"> "</span><span class=z-variable>$#</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> -gt</span><span class="z-constant z-numeric"> 0</span><span class=z-punctuation> ];</span><span class=z-keyword> do</span></span>
<span class=giallo-l><span class=z-keyword>    case</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-parameter">$1</span><span class="z-punctuation z-definition z-string">"</span><span class=z-keyword> in</span></span>
<span class=giallo-l><span class=z-string>        --config</span><span class=z-punctuation>|</span><span class=z-string>-c</span><span class="z-keyword z-operator">)</span></span>
<span class=giallo-l><span class=z-source>            config_file</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string">"</span><span class="z-variable z-parameter">$2</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            shift</span><span class="z-constant z-numeric"> 2</span></span>
<span class=giallo-l><span class=z-punctuation>            ;;</span></span>
<span class=giallo-l><span class=z-string>        --font</span><span class=z-punctuation>|</span><span class=z-string>-f</span><span class="z-keyword z-operator">)</span></span>
<span class=giallo-l><span class=z-source>            font_file</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string">"</span><span class="z-variable z-parameter">$2</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            shift</span><span class="z-constant z-numeric"> 2</span></span>
<span class=giallo-l><span class=z-punctuation>            ;;</span></span>
<span class=giallo-l><span class=z-string>        --output</span><span class=z-punctuation>|</span><span class=z-string>-o</span><span class="z-keyword z-operator">)</span></span>
<span class=giallo-l><span class=z-source>            output_path</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string">"</span><span class="z-variable z-parameter">$2</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            shift</span><span class="z-constant z-numeric"> 2</span></span>
<span class=giallo-l><span class=z-punctuation>            ;;</span></span>
<span class=giallo-l><span class=z-string>        --help</span><span class=z-punctuation>|</span><span class=z-string>-h</span><span class="z-keyword z-operator">)</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">            usage</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            exit</span><span class="z-constant z-numeric"> 0</span></span>
<span class=giallo-l><span class=z-punctuation>            ;;</span></span>
<span class=giallo-l><span class="z-keyword z-operator">        *)</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            echo</span><span class="z-punctuation z-definition z-string z-string"> "Unknown option: </span><span class="z-variable z-parameter">$1</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">            usage</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">            exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-punctuation>            ;;</span></span>
<span class=giallo-l><span class=z-keyword>    esac</span></span>
<span class=giallo-l><span class=z-keyword>done</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Comprueba si se proporcionan las opciones -c y -f.</span></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-keyword z-operator"> -z</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation> ];</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Error: --config|-c option is required."</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">    usage</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-keyword z-operator"> -z</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$font_file</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation> ];</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Error: --font|-f option is required."</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">    usage</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Comprueba si existen los archivos de configuraci√≥n y de fuentes.</span></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-keyword z-operator"> ! -f</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation> ];</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Error: Config file '</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-string z-punctuation z-definition z-string">' not found."</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-keyword z-operator"> ! -f</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$font_file</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation> ];</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "Error: Font file '</span><span class="z-variable z-other z-normal z-shell">$font_file</span><span class="z-string z-punctuation z-definition z-string">' not found."</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Extrae el t√≠tulo y los nombres de los men√∫s del archivo de configuraci√≥n.</span></span>
<span class=giallo-l><span class=z-source>title</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">awk</span><span class="z-string z-punctuation z-definition z-string"> -F' = ' '/^title/{print $2}' "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> tr</span><span class="z-string z-punctuation z-definition z-string"> -d '"'</span><span class=z-punctuation>)</span></span>
<span class=giallo-l><span class=z-source>menu_names</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">awk</span><span class="z-string z-punctuation z-definition z-string"> -F' = ' '/^menu/{f=1;next} /socials/{f=0} f && /name/{print $2}' "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> cut</span><span class="z-string z-punctuation z-definition z-string"> -d',' -f1</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> tr</span><span class="z-string z-punctuation z-definition z-string"> -d '"'</span><span class=z-punctuation> )</span></span>
<span class=giallo-l><span class=z-source>language_names</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">awk</span><span class="z-string z-punctuation z-definition z-string"> -F' = ' '/^language_name\./{print $2}' "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> tr</span><span class="z-string z-punctuation z-definition z-string"> -d '"'</span><span class=z-punctuation> )</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Si el sitio es multiling√ºe, obtiene las traducciones de los men√∫s.</span></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-keyword z-operator"> -n</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$language_names</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation> ];</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class=z-keyword>    for</span><span class=z-source> menu_name</span><span class=z-keyword> in</span><span class="z-punctuation z-definition z-variable z-source"> $menu_names</span><span class=z-punctuation>;</span><span class=z-keyword> do</span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment">        # Find the line with the menu name inside a [languages.*.translations] section and get the translated menus.</span></span>
<span class=giallo-l><span class=z-source>        menu_translation</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">awk</span><span class="z-string z-punctuation z-definition z-string"> -F' = ' "/</span><span class="z-constant z-character z-escape">\\</span><span class=z-string>[languages.*</span><span class="z-constant z-character z-escape">\\</span><span class=z-string>.translations</span><span class="z-constant z-character z-escape">\\</span><span class=z-string>]/{f=1;next} /^</span><span class="z-constant z-character z-escape">\\</span><span class=z-string>[/ {f=0} f && /</span><span class="z-variable z-other z-normal z-shell">$menu_name</span><span class=z-string> =/{print </span><span class="z-constant z-character z-escape">\$</span><span class="z-string z-punctuation z-definition z-string">2}" "</span><span class="z-variable z-other z-normal z-shell">$config_file</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> tr</span><span class="z-string z-punctuation z-definition z-string"> -d '"'</span><span class=z-punctuation> )</span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment">        # Add the found menu value to the translations string</span></span>
<span class=giallo-l><span class=z-source>        menu_names</span><span class="z-keyword z-operator">+=</span><span class="z-punctuation z-definition z-string">"</span><span class="z-variable z-other z-normal z-shell">$menu_translation</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l><span class=z-keyword>    done</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Combina las cadenas extra√≠das.</span></span>
<span class=giallo-l><span class=z-source>combined</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string">"</span><span class="z-variable z-other z-normal z-shell">$title$menu_names$language_names</span><span class="z-punctuation z-definition z-string">"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Obtiene los caracteres √∫nicos.</span></span>
<span class=giallo-l><span class=z-source>unique_chars</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-support z-function z-builtin">echo</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$combined</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> grep</span><span class=z-string> -o .</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> sort</span><span class=z-string> -u</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> tr</span><span class="z-string z-punctuation z-definition z-string"> -d '\n'</span><span class=z-punctuation>)</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Crea un archivo temporal para subset.woff2.</span></span>
<span class=giallo-l><span class=z-source>temp_subset</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">mktemp</span><span class=z-punctuation>)</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Crea el subconjunto.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">pyftsubset</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$font_file</span><span class="z-punctuation z-definition z-string">"</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-string z-punctuation z-definition z-string">    --text="</span><span class="z-variable z-other z-normal z-shell">$unique_chars</span><span class="z-punctuation z-definition z-string">"</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-string z-punctuation z-definition z-string">    --layout-features="*" --flavor="woff2" --output-file="</span><span class="z-variable z-other z-normal z-shell">$temp_subset</span><span class="z-punctuation z-definition z-string z-string">" --with-zopfli</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Codifica en Base64 el archivo temporal subset.woff2 y crea el archivo CSS.</span></span>
<span class=giallo-l><span class=z-source>base64_encoded_font</span><span class="z-keyword z-operator">=</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">base64</span><span class="z-string z-punctuation z-definition z-string"> -i "</span><span class="z-variable z-other z-normal z-shell">$temp_subset</span><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation>)</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">echo</span><span class="z-punctuation z-definition z-string z-string"> "@font-face{font-family:</span><span class="z-constant z-character z-escape">\"</span><span class=z-string>Inter Subset</span><span class="z-constant z-character z-escape">\"</span><span class=z-string>;src:url(data:application/font-woff2;base64,</span><span class="z-variable z-other z-normal z-shell">$base64_encoded_font</span><span class="z-string z-punctuation z-definition z-string">);}"</span><span class="z-keyword z-operator"> ></span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$output_path</span><span class="z-string z-punctuation z-definition z-string">/custom_subset.css"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Elimina el archivo temporal subset.woff2.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">rm</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$temp_subset</span><span class="z-punctuation z-definition z-string">"</span></span></code></pre><h2 id=uso><a aria-label="Anchor link for: uso" class="header-anchor no-hover-padding" href=#uso><span aria-hidden=true class=link-icon></span></a> Uso</h2><p>Guarda el script en alg√∫n lugar como <code>~/bin/subset_font</code>. Hazlo ejecutable con <code>chmod +x ~/bin/subset_font</code>.<p>Ahora puedes ejecutarlo con las opciones requeridas <code>--config</code> y <code>--font</code>:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-keyword z-operator">~</span><span class=z-source>/bin/subset_font --config path/to/config.toml --font path/to/font.woff2</span></span></code></pre><p>De forma predeterminada, esto generar√° un archivo <code>custom_subset.css</code> en el directorio actual. Usa <code>-o</code> o <code>--output</code> para especificar una ruta diferente:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-keyword z-operator">~</span><span class=z-source>/bin/subset_font -c path/to/config.toml -f path/to/font.woff2 -o path/to/output</span></span></code></pre><p>Coloca este archivo <code>custom_subset.css</code> dentro del directorio <code>static/</code>.<h2 id=automatizacion-con-un-pre-commit-hook><a aria-label="Anchor link for: automatizacion-con-un-pre-commit-hook" class="header-anchor no-hover-padding" href=#automatizacion-con-un-pre-commit-hook><span aria-hidden=true class=link-icon></span></a> Automatizaci√≥n con un Pre-commit Hook</h2><p>Es posible que cambies el t√≠tulo o las opciones del men√∫ de tu sitio, lo que har√≠a que el subconjunto personalizado deje de ser √∫til.<p>Para automatizar el proceso de creaci√≥n de este archivo, puedes integrar el script en un gancho (hook) pre-commit de Git que se active al detectar cambios en el archivo <code>config.toml</code>, ejecute el script y guarde el archivo CSS resultante en el directorio <code>static/</code> de tu sitio.<ol><li><p>Crea un archivo <code>.git/hooks/pre-commit</code> en tu proyecto de Git, si a√∫n no existe.</p><li><p>Hazlo ejecutable con <code>chmod +x .git/hooks/pre-commit</code>.</p><li><p>Agrega el siguiente c√≥digo al archivo:</p></ol><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># Comprueba si config.toml se ha modificado.</span></span>
<span class=giallo-l><span class=z-keyword>if</span><span class="z-entity z-name z-function"> git</span><span class=z-string> diff --cached --name-only</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> grep</span><span class="z-string z-punctuation z-definition z-string"> -q "config.toml"</span><span class=z-punctuation>;</span><span class=z-keyword> then</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">    echo</span><span class="z-punctuation z-definition z-string z-string"> "config.toml modified. Running subset_font‚Ä¶"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment">    # Ejecuta el script subset_font.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">    ~/bin/subset_font</span><span class=z-string> -c config.toml -f static/fonts/Inter4.woff2 -o static/</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment">    # A√±adie el subset.css reci√©n generado al commit.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">    git</span><span class=z-string> add static/custom_subset.css</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span></code></pre><p>Aseg√∫rate de modificar el script para que coincida con la ruta donde has guardado el script <code>subset_font</code>. Las rutas de configuraci√≥n y fuente deber√≠an funcionar correctamente con la configuraci√≥n predeterminada de tabi.<p>Ahora, cada vez que hagas cambios en tu proyecto de Git y los confirmes, el gancho pre-commit verificar√° las modificaciones en el archivo <code>config.toml</code> y ejecutar√° autom√°ticamente el script <code>subset_font</code> para actualizar el archivo <code>custom_subset.css</code>.<p>Por cierto, si te interesa una forma de actualizar autom√°ticamente la fecha de tus publicaciones en Zola o comprimir autom√°ticamente tus archivos PNG, echa un vistazo a <a class=external href=https://osc.garden/es/blog/zola-date-git-hook/ rel=external>esta publicaci√≥n</a>.<p>Si deseas utilizar todos los scripts a la vez (compresi√≥n de archivos PNG, actualizaci√≥n de la fecha y creaci√≥n del subconjunto de fuentes), combina su c√≥digo en un solo archivo <code>.git/hooks/pre-commit</code>.</section><form action="https://vhiweeypifbwacashxjz.supabase.co/rest/v1/rpc/increment_hits?apikey=sb_publishable_EoB7MFJhCmb6PiAk-GPJ4w_PGhQ44Ru" class=iine-form method=post><input name=page_slug type=hidden value=/blog/custom-font-subset/><button aria-label="Me gusta esta publicaci√≥n" title="Me gusta esta publicaci√≥n" class=iine-button data-icon=thumbs_up data-slug=/blog/custom-font-subset/>üëç</button></form><nav class="full-width article-navigation"><div><a aria-describedby=left_title aria-label=Siguiente href=https://welpo.github.io/tabi/es/blog/comments/><span class=arrow>‚Üê</span>¬†Siguiente</a><p aria-hidden=true id=left_title>A√±ade comentarios a tus publicaciones con estas 4 plataformas</div><div><a aria-describedby=right_title aria-label=Anterior href=https://welpo.github.io/tabi/es/blog/security/>Anterior¬†<span class=arrow>‚Üí</span></a><p aria-hidden=true id=right_title>Seguro por defecto</div></nav></article></main><span class=hidden id=copy-success> Copiado! </span><span class=hidden id=copy-init> Copiar c√≥digo al portapapeles </span><script defer src=https://welpo.github.io/tabi/js/copyCodeToClipboard.min.js></script><script defer src=https://cdn.jsdelivr.net/gh/welpo/iine@main/iine.mini.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://welpo.github.io/tabi/es/atom.xml> <img alt=feed loading=lazy src=https://welpo.github.io/tabi/social_icons/rss.svg title=feed> </a><li class=js><a class="nav-links no-hover-padding social" data-encoded-email=dGFiaUBvc2MuZ2FyZGVu href=#><img alt=email loading=lazy src=https://welpo.github.io/tabi/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/welpo/> <img alt=github loading=lazy src=https://welpo.github.io/tabi/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://soundcloud.com/oskerwyld> <img alt=soundcloud loading=lazy src=https://welpo.github.io/tabi/social_icons/soundcloud.svg title=soundcloud> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://instagram.com/oskerwyld> <img alt=instagram loading=lazy src=https://welpo.github.io/tabi/social_icons/instagram.svg title=instagram> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://youtube.com/@oskerwyld> <img alt=youtube loading=lazy src=https://welpo.github.io/tabi/social_icons/youtube.svg title=youtube> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://open.spotify.com/artist/5Hv2bYBhMp1lUHFri06xkE> <img alt=spotify loading=lazy src=https://welpo.github.io/tabi/social_icons/spotify.svg title=spotify> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/about/> sobre m√≠ </a><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/es/privacy/> pol√≠tica de privacidad </a><li><a class="nav-links no-hover-padding" href=https://tabi-stats.osc.garden/> estad√≠sticas del sitio </a><li><a class="nav-links no-hover-padding" href=https://welpo.github.io/tabi/sitemap.xml> mapa del sitio </a></ul> </small></nav><div class=credits><small> Impulsado por <a href=https://www.getzola.org>Zola</a> y <a href=https://github.com/welpo/tabi>tabi</a> ‚Ä¢ <a href=https://github.com/welpo/tabi> C√≥digo del sitio </a></small></div></section><script async src=https://welpo.github.io/tabi/js/decodeMail.min.js></script><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Buscar</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Buscar‚Ä¶ role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Borrar b√∫squeda" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No hay resultados</span><span id=one_results> $NUMBER resultado</span><span id=many_results> $NUMBER resultados</span><span id=two_results> $NUMBER resultados</span><span id=few_results> $NUMBER resultados</span></div><div id=results role=listbox></div></div></div></div></footer>